<?xml version="1.0" ?>
<sdf version="1.8">
  <world name="test_robot">

    <!-- Gravity -->
    <gravity>0 0 -9.81</gravity>

    <!-- Ground plane -->
    <model name="ground_plane">
        <static>true</static>
        <link name="link">
            <collision name="collision">
            <geometry>
                <plane>
                <normal>0 0 1</normal>
                </plane>
            </geometry>
            </collision>
            <visual name="visual">
            <geometry>
                <plane>
                <normal>0 0 1</normal>
                <size>100 100</size>
                </plane>
            </geometry>
            <material>
                <ambient>0.8 0.8 0.8 1</ambient>
                <diffuse>0.8 0.8 0.8 1</diffuse>
                <specular>0.8 0.8 0.8 1</specular>
            </material>
            </visual>
        </link>
    </model>

    <!-- Robot Model -->
    <model name="cdpr_robot">
      <pose>0 0 0 0 0 0</pose>

      <!-- Root link (link0) -->
      <link name="link0">
        <pose>0 0 0.5 0 0 0</pose>
        <inertial>
          <mass>1.0</mass>
          <inertia>
            <ixx>0.01</ixx>
            <iyy>0.01</iyy>
            <izz>0.01</izz>
          </inertia>
        </inertial>
        <collision name="collision0">
          <geometry>
            <box>
              <size>0.2 0.2 0.2</size>
            </box>
          </geometry>
        </collision>
        <visual name="visual0">
          <geometry>
            <box>
              <size>0.2 0.2 0.2</size>
            </box>
          </geometry>
          <material>
            <ambient>0 0 1 1</ambient>
            <diffuse>0 0 1 1</diffuse>
          </material>
        </visual>
      </link>

      <!-- Intermediate links -->
      <link name="link1">
        <pose>0.5 0 0.5 0 0 0</pose>
        <inertial>
          <mass>0.5</mass>
          <inertia>
            <ixx>0.005</ixx>
            <iyy>0.005</iyy>
            <izz>0.005</izz>
          </inertia>
        </inertial>
        <visual name="visual1">
          <geometry>
            <sphere>
              <radius>0.1</radius>
            </sphere>
          </geometry>
          <material>
            <ambient>0 1 0 1</ambient>
            <diffuse>0 1 0 1</diffuse>
          </material>
        </visual>
      </link>

      <link name="link2">
        <pose>1.0 0 0.5 0 0 0</pose>
        <inertial>
          <mass>0.5</mass>
          <inertia>
            <ixx>0.005</ixx>
            <iyy>0.005</iyy>
            <izz>0.005</izz>
          </inertia>
        </inertial>
        <visual name="visual2">
          <geometry>
            <sphere>
              <radius>0.1</radius>
            </sphere>
          </geometry>
          <material>
            <ambient>1 1 0 1</ambient>
            <diffuse>1 1 0 1</diffuse>
          </material>
        </visual>
      </link>

      <!-- Extremal link (link3) - kinematic to remain fixed -->
      <link name="link3">
        <pose>1.5 0 0.5 0 0 0</pose>
        <kinematic>true</kinematic>
        <visual name="visual3">
          <geometry>
            <sphere>
              <radius>0.1</radius>
            </sphere>
          </geometry>
          <material>
            <ambient>1 0 0 1</ambient>
            <diffuse>1 0 0 1</diffuse>
          </material>
        </visual>
      </link>

      <!-- Joints connecting links -->
      <joint name="joint0_1" type="revolute">
        <parent>link0</parent>
        <child>link1</child>
        <axis>
          <xyz>0 0 1</xyz>
        </axis>
      </joint>

      <joint name="joint1_2" type="revolute">
        <parent>link1</parent>
        <child>link2</child>
        <axis>
          <xyz>0 0 1</xyz>
        </axis>
      </joint>

      <joint name="joint2_3" type="revolute">
        <parent>link2</parent>
        <child>link3</child>
        <axis>
          <xyz>0 0 1</xyz>
        </axis>
      </joint>
    </model>

    <!-- Pose publisher to move root link -->
    <plugin name="pose_publisher" filename="libignition-gazebo-pose-publisher-system.so">
        <link>link0</link>
        <model>cdpr_robot</model>
        <publish_link_pose>true</publish_link_pose>
        <publish_visual_pose>false</publish_visual_pose>
        <publish_collision_pose>false</publish_collision_pose>
        <publish_sensor_pose>false</publish_sensor_pose>
        <publish_model_pose>false</publish_model_pose>
        <publish_nested_model_pose>false</publish_nested_model_pose>
        <use_pose_vector_msg>false</use_pose_vector_msg>
        <update_frequency>-1</update_frequency>
    </plugin>

  </world>
</sdf>
